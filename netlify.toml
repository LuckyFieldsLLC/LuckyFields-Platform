[build]
  # Build apps/lab
  command = "npm run build -w @luckyfields/lab"
  publish = "apps/lab/dist"
  functions = "netlify/functions"

[build.environment]
  # Pin Node version used by Netlify build image.
  NODE_VERSION = "20"
  # Ensure optional deps (like @rollup/rollup-<platform>) are installed.
  NPM_CONFIG_OPTIONAL = "true"
  # Keep default flags lean but DO NOT omit optional deps.
  NPM_FLAGS = "--no-audit --progress=false"

  # Use esbuild for functions bundling to avoid rollup dependency.
  node_bundler = "esbuild"
  included_files = ["data/*.json"]

# Optional: local dev hints; cloud deploy ignores this.
[dev]
  framework = "#static"
  publish = "docs"
  functions = "netlify/functions"
  autoLaunch = false

# Redirects - Not used for root landing page
