[build]
  # Build apps/lab (Next.js)
  command = "npm run build -w @luckyfields/lab"
  publish = "apps/lab/.next"
  functions = "netlify/functions"

[build.environment]
  # Pin Node version used by Netlify build image.
  NODE_VERSION = "20"
  # Ensure optional deps are installed.
  NPM_CONFIG_OPTIONAL = "true"
  # Keep default flags lean.
  NPM_FLAGS = "--no-audit --progress=false"

[functions]
  # Use esbuild for functions bundling to avoid rollup dependency.
  node_bundler = "esbuild"
  included_files = ["data/*.json"]

# Optional: local dev hints.
[dev]
  framework = "#static"
  publish = "apps/lab/dist"
  functions = "netlify/functions"
  autoLaunch = false
